// Zed keymap
//
// For information on binding keys, see the Zed
// documentation: https://zed.dev/docs/key-bindings
//
// To see the default key bindings run `zed: open default keymap`
// from the command palette.
[
    // Contexts
    // https://github.com/zed-industries/zed/issues/14718

    {
        "bindings": {
            // disable zoom
            "shift-escape": null,
        },
    },

    // Workspace
    {
        "context": "Editor && vim_mode != insert",
        "bindings": {
            "space f f": "file_finder::Toggle",
            "space f w": "pane::DeploySearch",
            "space s s": "tab_switcher::ToggleAll",
            "space s t": "terminal_panel::Toggle",
            "space s o": "projects::OpenRecent",
        },
    },

    // GitPanel
    {
        "context": "GitPanel || CommitEditor || GitCommit || Editor",
        "bindings": {
            "ctrl-w": "workspace::CloseActiveDock",
            "shift-escape": "workspace::CloseActiveDock",
            // ... or other keybindings
        },
    },

    // Dock
    {
        "context": "Dock",
        "bindings": {
            "ctrl-w h": "workspace::ActivatePaneLeft",
            "ctrl-w l": "workspace::ActivatePaneRight",
            "ctrl-w k": "workspace::ActivatePaneUp",
            "ctrl-w j": "workspace::ActivatePaneDown",
            "ctrl-w": "workspace::CloseActiveDock",
            // ... or other keybindings
        },
    },

    // vim_operator == a || vim_operator == i || vim_operator == cs
    {
        "context": "vim_operator == a || vim_operator == i || vim_operator == cs",
        "bindings": {
            "q": "vim::MiniQuotes",
            "b": "vim::Parentheses",
            "B": "vim::CurlyBrackets",
        },
    },

    // VimControl && !menu
    {
        "context": "VimControl && !menu",
        "bindings": {
            // Put key bindings here if you want them to work in normal & visual mode.
            "space n": "pane::RevealInProjectPanel",
        },
    },

    // vim_mode == normal && !menu
    {
        "context": "vim_mode == normal && !menu",
        "bindings": {
            "g u": "editor::FindAllReferences",
            "space c l": "editor::GoToDiagnostic",
            "space c h": "editor::GoToPreviousDiagnostic",
            "space q": "pane::CloseActiveItem",

            // Agent
            "space g C": "agent::ToggleFocus",

            // Git
            "space g b": "git::Switch",
            "space g f": "git::Fetch",
            "space g k": "git::Push",
            "space g p": "git::Pull",
            "space g c": "git_panel::ToggleFocus",

            // Random Quality-of-life improvements
            "shift-y": ["workspace::SendKeystrokes", "y $"], // Use neovim's yank behavior: yank to end of line.
            "backspace": ["workspace::SendKeystrokes", "c i w"],
            "ctrl-u": ["workspace::SendKeystrokes", "ctrl-u z z"],
            "ctrl-d": ["workspace::SendKeystrokes", "ctrl-d z z"],
            "n": ["workspace::SendKeystrokes", "n z z"],
            "N": ["workspace::SendKeystrokes", "N z z"],
            "ctrl-s": "editor::ShowSignatureHelp",
            "g i": "editor::GoToImplementation",

            // Better HJKL and Arrow key movement
            "h": ["workspace::SendKeystrokes", "g h"],
            "j": ["workspace::SendKeystrokes", "g j"],
            "k": ["workspace::SendKeystrokes", "g k"],
            "l": ["workspace::SendKeystrokes", "g l"],
            "left": ["workspace::SendKeystrokes", "g h"],
            "down": ["workspace::SendKeystrokes", "g j"],
            "up": ["workspace::SendKeystrokes", "g k"],
            "right": ["workspace::SendKeystrokes", "g l"],
        },
    },

    // vim_mode == insert
    {
        "context": "vim_mode == insert",
        "bindings": {
            // "j k": "vim::NormalBefore" // In insert mode, make jk escape to normal mode.
        },
    },

    // vim_mode == visual
    {
        "context": "vim_mode == visual",
        "bindings": {
            "<": ["workspace::SendKeystrokes", "< g v"],
            ">": ["workspace::SendKeystrokes", "> g v"],
        },
    },

    // EmptyPane || SharedScreen
    {
        "context": "EmptyPane || SharedScreen",
        "bindings": {
            // Put key bindings here (in addition to the context above) if you want them to
            // work when no editor exists.
            "space f f": "file_finder::Toggle",
            "space space": "file_finder::Toggle",
        },
    },

    // ProjectPanel
    {
        "context": "ProjectPanel",
        "bindings": {
            "ctrl-w": "workspace::CloseActiveDock",
            "shift-escape": "workspace::CloseActiveDock",
        },
    },

    // Terminal
    {
        "context": "Terminal",
        "bindings": {
            "ctrl-w": "workspace::CloseActiveDock",
            "shift-escape": "workspace::CloseActiveDock",
        },
    },
]
